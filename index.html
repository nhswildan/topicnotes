<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Summary Review</title>
<link rel="icon" type="image/png" href="./Favicon NHS.png">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --accent:#2563eb;
  --bg:#f9fafb;
  --surface:#fff;
  --border:#e5e7eb;
  --radius:12px;
}
*{box-sizing:border-box;}
body {margin:0;font-family:"Noto Sans",sans-serif;background:var(--bg);color:#111;min-height:100vh;display:flex;flex-direction:column;}
header {display:flex;align-items:center;justify-content:space-between;padding:10px 24px;background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10;}
.header-left img{height:30px;width:auto;}
.header-center{text-align:center;flex:1;}
.header-center h1{margin:0;font-size:18px;font-weight:600;}
.header-center small{color:#6b7280;font-size:12px;}
.header-right{display:flex;align-items:center;gap:8px;font-size:14px;color:#374151;}
main{flex:1;width:100%;padding:32px 5%;}
.top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;}
.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;}
.btn{background:var(--accent);color:white;border:none;padding:8px 14px;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px;transition:all .2s ease;}
.btn:hover{opacity:0.9;}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid var(--accent);}
.icon-btn{background:var(--surface);border:1px solid var(--border);border-radius:6px;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;font-size:16px;color:#374151;}
.icon-btn:hover{background:#f3f4f6;color:var(--accent);}
.history-controls{display:flex;gap:6px;}
.select-class{display:flex;flex-wrap:wrap;gap:8px;margin:16px 0 20px;}
.tag{border:1px solid var(--border);border-radius:6px;padding:6px 14px;cursor:pointer;background:var(--surface);font-size:14px;}
.tag.active{background:var(--accent);color:white;border-color:var(--accent);}
.tag:hover{background:#eff6ff;}
.table-wrap{overflow-x:auto;overflow-y:hidden;}
table.sheet {
  border-collapse: separate;
  border-spacing:0;
  min-width:600px;
  width:auto;
  font-size:14px;
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
}
th, td{
  border:1px solid var(--border);
  padding:10px 8px;
  text-align:center;
  white-space:nowrap;
}
th{
  background:#f3f4f6;
  font-weight:600;
}
td.name{text-align:left;font-weight:500; background:#fff;}
td.no{width:40px; background:#fff;}
td.name{width:140px;}

/* Sticky first 2 columns with proper left offsets */
th:first-child, td.no {
  position: sticky;
  left: 0;
  z-index:3;
}
th:nth-child(2), td.name {
  position: sticky;
  left: 40px; /* lebar kolom No */
  z-index:3;
}

/* Warnanya */
th:first-child, th:nth-child(2) {
  background: #f3f4f6; /* header abu-abu */
}
td.no, td.name {
  background: #fff; /* isi sel putih */
}

/* Rounded corners */
th:first-child{border-top-left-radius:var(--radius);}
th:last-child{border-top-right-radius:var(--radius);}
tr:last-child td:first-child{border-bottom-left-radius:var(--radius);}
tr:last-child td:last-child{border-bottom-right-radius:var(--radius);}

.cell{cursor:pointer;user-select:none;border-radius:6px;padding:4px;}
.cell.check{background:#dbeafe;color:var(--accent);}
.cell.cross{background:#fee2e2;color:#dc2626;}
.sum{font-weight:600;}

.fab{
  position:fixed;bottom:24px;right:24px;
  background:var(--accent);color:white;border:none;border-radius:50%;
  width:56px;height:56px;font-size:28px;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.2);
  transition:all .2s ease;
}
.fab:hover{transform:scale(1.05);}
footer{text-align:center;padding:12px;font-size:13px;color:#6b7280;border-top:1px solid var(--border);background:var(--surface);}

/* Print */
@media print{
  th, td{position: static !important; background:#fff !important;}
  .table-wrap{overflow:visible !important;}
}
</style>
</head>
<body>
<header>
  <div class="header-left"><img src="./Logo NHS NA.png" alt="Logo"></div>
  <div class="header-center"><h1>Summary Review</h1><small>Academic Year 2025/2026</small></div>
  <div class="header-right"><span>Wildan Fido Ramadhan</span></div>
</header>
<main>
<div class="top-bar">
  <div class="controls">
    <button class="btn ghost" id="delRow">Hapus Baris</button>
    <button class="btn ghost" id="addCol">+ Kolom</button>
    <button class="btn ghost" id="delCol">Hapus Kolom</button>
    <button class="btn" id="print">Cetak PDF</button>
  </div>
  <div class="history-controls">
    <button class="icon-btn" id="undoBtn">⟲</button>
    <button class="icon-btn" id="redoBtn">⟳</button>
  </div>
</div>
<div class="select-class" id="classTags"></div>
<div class="table-wrap">
  <table class="sheet">
    <thead id="thead"></thead>
    <tbody id="tbody"></tbody>
  </table>
</div>
<button class="fab" id="addRow">+</button>
</main>
<footer>© Wildan 2025</footer>
<script>
const CLASSES=["G12 Antropologi","G11 Antropologi 1","G11 Antropologi 2","G10 A Geografi","G10B Geografi","G10 Inter A Geografi","G10 Inter B Geografi","G10 Inter A Sosiologi","G10 Inter B Sosiologi"];
const STORAGE="penilaian_v3::";
let state={kelas:CLASSES[0],data:{}};
let selectedColIndex=null;
let undoStack=[], redoStack=[];
function pushHistory(){undoStack.push(JSON.stringify(state.data[state.kelas])); if(undoStack.length>30)undoStack.shift(); redoStack=[];}
function undo(){if(!undoStack.length)return; redoStack.push(JSON.stringify(state.data[state.kelas])); state.data[state.kelas]=JSON.parse(undoStack.pop()); save(); render();}
function redo(){if(!redoStack.length)return; undoStack.push(JSON.stringify(state.data[state.kelas])); state.data[state.kelas]=JSON.parse(redoStack.pop()); save(); render();}
function el(id){return document.getElementById(id);}
function init(){
  const tagWrap=el("classTags");
  CLASSES.forEach(cls=>{
    const t=document.createElement("div");
    t.textContent=cls;
    t.className="tag"+(cls===state.kelas?" active":"");
    t.onclick=()=>{state.kelas=cls;render();};
    tagWrap.appendChild(t);
    const saved=load(cls);
    state.data[cls]=saved || {headers:Array(10).fill().map((_,i)=>"K"+(i+1)),rows:[]};
  });
  el("addRow").onclick=addRow;
  el("delRow").onclick=()=>{pushHistory(); state.data[state.kelas].rows.pop(); save(); render();};
  el("addCol").onclick=addColRightOfSelected;
  el("delCol").onclick=delSelectedCol;
  el("undoBtn").onclick=undo;
  el("redoBtn").onclick=redo;
  el("print").onclick=()=>window.print();
  document.addEventListener("keydown",e=>{if(e.ctrlKey&&e.key==="z")undo(); if(e.ctrlKey&&e.key==="y")redo();});
  render();
}
function render(){
  document.querySelectorAll(".tag").forEach(t=>t.classList.toggle("active",t.textContent===state.kelas));
  const tbl=state.data[state.kelas];
  const head=el("thead"),body=el("tbody");
  head.innerHTML=""; body.innerHTML="";
  const trh=document.createElement("tr");
  ["No","Nama Siswa",...tbl.headers,"Skor"].forEach((h,i)=>{
    const th=document.createElement("th");
    th.textContent=h;
    if(i>=2 && i<tbl.headers.length+2){
      th.contentEditable=true;
      th.onclick=()=>{selectedColIndex=i-2;};
      th.oninput=e=>{tbl.headers[i-2]=e.target.textContent; save();};
    }
    trh.appendChild(th);
  });
  head.appendChild(trh);
  tbl.rows.forEach((r,ri)=>{
    const tr=document.createElement("tr");
    const tdNo=document.createElement("td"); tdNo.className="no"; tdNo.textContent=ri+1; tr.appendChild(tdNo);
    const tdName=document.createElement("td"); tdName.className="name"; tdName.contentEditable=true; tdName.textContent=r.name||""; tdName.oninput=e=>{r.name=e.target.textContent; save();}; tr.appendChild(tdName);
    r.cells.forEach((c,ci)=>{
      const td=document.createElement("td");
      const div=document.createElement("div");
      div.className="cell"+(c==="check"?" check":c==="cross"?" cross":"");
      div.textContent=c==="check"?"✔":c==="cross"?"✖":"";
      div.onclick=()=>{pushHistory(); r.cells[ci]=r.cells[ci]===""?"check":r.cells[ci]==="check"?"cross":""; save(); render();};
      td.appendChild(div); tr.appendChild(td);
    });
    const tdSum=document.createElement("td"); tdSum.className="sum"; tdSum.textContent=r.cells.filter(x=>x==="check").length; tr.appendChild(tdSum);
    body.appendChild(tr);
  });
}
function addRow(){pushHistory(); const t=state.data[state.kelas]; t.rows.push({name:"Nama",cells:Array(t.headers.length).fill("")}); save(); render();}
function addColRightOfSelected(){pushHistory(); const t=state.data[state.kelas]; const i=selectedColIndex!==null?selectedColIndex+1:t.headers.length; t.headers.splice(i,0,"K"+(t.headers.length+1)); t.rows.forEach(r=>r.cells.splice(i,0,"")); save(); render();}
function delSelectedCol(){if(selectedColIndex===null)return alert("Klik header kolom yang ingin dihapus dulu!"); pushHistory(); const t=state.data[state.kelas]; t.headers.splice(selectedColIndex,1); t.rows.forEach(r=>r.cells.splice(selectedColIndex,1)); selectedColIndex=null; save(); render();}
function save(){localStorage.setItem(STORAGE+state.kelas,JSON.stringify(state.data[state.kelas]));}
function load(k){try{return JSON.parse(localStorage.getItem(STORAGE+k));}catch{return null;}}
init();
</script>
</body>
</html>
